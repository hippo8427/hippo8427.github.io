---
title: Weekly Paper 08
date: 2025-07-21
layout: single
---

<br>

## 📌 세션 기반 인증(Session-based Authentication)

### 🔍 개념 정리

**세션 기반 인증이란?**  
- 사용자가 **로그인 → 서버 인증 → 세션 생성**  
- 세션 식별용 ID를 쿠키에 담아 클라이언트에 전달  
- 이후 클라이언트는 요청마다 세션 ID 전송 → 서버가 세션 데이터 확인 후 인증

<br>

#### 🔍 세션 동작 흐름

1. 클라이언트가 로그인 요청 (ID, PW 전송)
2. 서버가 인증 성공 → 세션 생성
3. 서버는 세션 ID를 쿠키에 담아 클라이언트에 전달
4. 클라이언트는 이후 요청마다 세션 ID 포함
5. 서버는 세션 ID로 사용자 식별 및 인증

<br>

<details> 
<summary><strong style="font-size: 1.2em;">🔸 세션 기반 인증 팁</strong></summary> 
<div style="background: #f0f0f0; padding: 1em;" markdown="1">

- **SameSite, Secure, HttpOnly** 옵션을 쿠키 설정 시 반드시 적용
- production 환경에서는 **Redis** 등 외부 세션 저장소 사용 권장
- 클라이언트와 서버가 도메인 분리되어 있다면 CORS 및 쿠키 옵션 주의
- 세션 유효시간 설정 필수
- **Express.js**에서 `express-session` 사용 시 secret은 반드시 환경 변수로 관리
- 세션 ID 탈취 방지를 위해 반드시 HTTPS 사용
- 로그인/로그아웃 시 세션을 명확히 삭제

</div>
</details>

---

<br><br>


## 📌 토큰 기반 인증(Token-based Authentication)

### 🔍 개념 정리

**토큰 기반 인증이란?**  
- 로그인 성공 시 서버가 토큰(JWT 등) 발급 → 클라이언트가 저장
- 클라이언트는 요청 시 Authorization 헤더에 토큰 포함
- 서버는 토큰 검증 후 인증 처리

<br>

#### 🔍 토큰 동작 흐름

1. 클라이언트가 로그인 요청 (ID, PW 전송)
2. 서버가 인증 성공 → 토큰 발급
3. 클라이언트가 토큰 저장 (로컬스토리지, 세션스토리지, 메모리, 쿠키 등)
4. 이후 요청 시 Authorization 헤더에 토큰 포함
5. 서버가 토큰을 검증 → 사용자 인증

<br>

<details> 
<summary><strong style="font-size: 1.2em;">🔸 토큰 기반 인증 팁</strong></summary> 
<div style="background: #f0f0f0; padding: 1em;" markdown="1">

- **토큰 저장**은 LocalStorage보다는 HttpOnly 쿠키나 메모리 권장 (탈취 방지)
- HTTPS 반드시 사용 (탈취 방지)
- 토큰 만료 검증 필수 (exp claim 체크)
- CORS 설정 시 `credentials: true` 옵션 여부에 유의 (옵션을 켜야 쿠키나 인증헤더등 민감정보가 포함되어 전송됨)
- Access / Refresh 토큰 분리 권장
    - Access Token은 수명 짧게 (데이터 엑세스용)
    - Refresh Token은 수명 길게 설정 후 DB에 저장 권장 (엑세스토큰 재 발급용)
- 로그아웃 시 Refresh Token 무효화 로직 반드시 구현
- **JWT** 사용 시 비밀키 노출 방지 필수

</div>
</details>

---

<br><br>

## 📌 세션 vs 토큰 비교

| 구분                 | 세션 기반 인증                   | 토큰 기반 인증                     |
| ----------------- | --------------------------- | ------------------------------ |
| **서버 상태 관리**   | Session 저장 (Stateful)       | Stateless 설계가 원칙이나 일부 저장 필요할 수 있음 |
| **확장성**         | 낮음 (세션 공유 필요)          | 높음 (토큰 자체에 정보 포함)      |
| **보안 이슈**       | 세션 ID 탈취                  | 토큰 탈취                        |
| **보관 위치**       | 서버 + 쿠키                   | 클라이언트 (쿠키, 메모리, 스토리지) |
| **모바일 환경**     | 다소 불리                     | 유리                             |
| **로그아웃 처리**    | 서버 세션 삭제로 즉시 가능      | 토큰은 서버 저장이 없으면 즉시 무효화 어렵다 |
| **무효화 처리**      | 세션 삭제로 간단               | 토큰 블랙리스트 관리 필요          |

---

#### 📍 토큰도 일부 저장하는 이유

- **토큰 기반 인증**은 원래 서버가 세션을 저장하지 않는 **Stateless** 구조가 원칙
- 하지만 현실적으로 일부 저장 필요할 때가 많음
    - 로그아웃 시 토큰을 무효화하기 위해
    - 탈취된 토큰 블랙리스트 관리
    - Refresh Token은 보안상 DB에 저장 권장
- 완전 Stateless 시스템은 로그아웃이나 토큰 폐기가 어렵다는 단점 존재
